import{j as S,D as T,p as A,r as d,c as b,a as t,s as n,C as p,x as g,v as f,m as o,t as x,d as h,k as D,q as F,o as y,_ as I}from"./Dv50Am8a.js";import{u as N}from"./BfKjuDNB.js";const M={class:"page-container"},O={class:"edit-card"},P={class:"input-group title-group"},R={class:"word-count"},$={class:"input-group content-group"},j=["maxlength"],q={class:"word-count"},E={class:"action-area"},G={class:"upload-area"},H={key:0,class:"preview-box"},J=["src"],K={class:"upload-btn"},L=S({__name:"edit",setup(Q){const w=T(),{token:_}=A(),C=N(),l=d(""),a=d(""),r=d(""),v=d(""),c=i=>w.fullPath.split("?")[1]==i,m=()=>{l.value="",a.value="",r.value=""},k=async i=>{const s=i.target.files?.[0];if(s)try{const{base64:u}=await C(s,{maxSizeMB:1});r.value=u}catch{alert("图片压缩失败，请重新选择图片！")}},V=async(i,e)=>{const s={};_.value&&(s.Authorization=`Bearer ${_.value}`);const{data:u}=await F("/api/private/"+i,{method:"POST",body:e,headers:s,watch:!1},"$VuhgbvgOt5");if(u.value?.code!=200)return alert("发布文章失败!");alert("发布文章成功!"),m()},z=async()=>{if(a.value.length<10||a.value.length>1e3)return alert("请填写不少于10个字的内容！");V("article",{content:a.value})},B=()=>{l.value&&a.value?(alert("加入【愿望清单】成功！"),m()):alert("标题或内容不能为空！")},U=()=>{r.value&&a.value&&l.value?(m(),alert("存入【恋爱相册】成功！")):alert("请先上传图片并填写标题和内容！")};return(i,e)=>(y(),b("div",M,[t("div",O,[n(t("div",P,[n(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>g(l)?l.value=s:null),type:"text",placeholder:"起个名字吧~",maxlength:"10",class:"edit-input"},null,512),[[f,o(l),void 0,{lazy:!0}]]),t("span",R,x(o(l).length)+"/20",1)],512),[[p,!c("/recording")]]),t("div",$,[n(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=s=>g(a)?a.value=s:null),placeholder:"记录下此刻的心情和故事吧...",class:"edit-textarea",maxlength:c("/recording")?1e3:100},null,8,j),[[f,o(a),void 0,{lazy:!0}]]),t("span",q,x(o(a).length)+"/1000",1)]),t("div",E,[n(t("button",{onClick:z,class:"action-btn record-btn"},e[3]||(e[3]=[t("i",{class:"icon-pen"},null,-1),h(" 保存点点滴滴 ")]),512),[[p,c("/recording")]]),n(t("button",{onClick:B,class:"action-btn record-btn"},e[4]||(e[4]=[t("i",{class:"icon-list"},null,-1),h(" 加入愿望清单 ")]),512),[[p,c("/aspiration")]]),n(t("div",G,[o(r)?(y(),b("div",H,[t("img",{src:o(r),alt:"预览图",class:"preview-img"},null,8,J)])):D("",!0),t("label",K,[e[5]||(e[5]=t("span",null,"选择照片",-1)),t("input",{type:"file",name:"file",accept:"image/*",onChange:k,class:"file-input"},null,32)]),n(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>g(v)?v.value=s:null),type:"datetime-local",class:"img-time-input"},null,512),[[f,o(v),void 0,{lazy:!0}]]),t("button",{onClick:U,class:"action-btn album-btn"},e[6]||(e[6]=[t("i",{class:"icon-img"},null,-1),h(" 存入恋爱相册 ")]))],512),[[p,c("/photo")]])])])]))}}),Y=I(L,[["__scopeId","data-v-d3ee8f08"]]);export{Y as default};
